name: Video Catcher Pro
on:
  workflow_dispatch:
    inputs:
      url:
        description: 'Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±'
        required: true
      duration:
        description: 'Ø§Ù„Ù…Ø¯Ø© Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚'
        required: true
        default: '10'

jobs:
  capture_job:
    runs-on: ubuntu-latest
    steps:
      - name: Setup Environment
        run: sudo apt-get update && sudo apt-get install -y ffmpeg curl

      - name: Capture and Compress
        run: |
          # Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ Ø§Ù„Ø³ÙƒØ±Ø¨Øª
          TOKEN="8589322439:AAEmq9nKn8K5RORCPLx8pQ-wAYVaNj8NM9g"
          CHAT_ID="6849625315"
          URL="${{ github.event.inputs.url }}"
          MIN="${{ github.event.inputs.duration }}"
          SEC=$(( $MIN * 60 ))
          
          echo "ğŸ“¡ Ø¬Ø§Ø±ÙŠ Ø³Ø­Ø¨ Ø§Ù„Ø¨Ø« Ù„Ù…Ø¯Ø© $MIN Ø¯Ù‚ÙŠÙ‚Ø©..."
          ffmpeg -y -reconnect 1 -reconnect_at_eof 1 -reconnect_streamed 1 -i "$URL" -t $SEC -c copy raw.ts
          
          echo "âš™ï¸ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¶ØºØ· (HEVC)... Ù‚Ø¯ ÙŠØ³ØªØºØ±Ù‚ Ù‡Ø°Ø§ Ø¯Ù‚Ø§Ø¦Ù‚..."
          ffmpeg -y -i raw.ts -c:v libx265 -crf 28 -preset ultrafast -c:a aac -movflags faststart final.mp4
          
          SIZE=$(du -h final.mp4 | cut -f1)
          
          echo "âœ… ØªÙ… Ø§Ù„Ù‚Ù†Øµ! Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„ØªÙ„Ø¬Ø±Ø§Ù…..."
          # Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Curl
          curl -v -F "video=@final.mp4" -F "caption=ğŸ¥ ØªÙ… Ø§Ù„Ù‚Ù†Øµ Ø¨Ù†Ø¬Ø§Ø­!%0Aâ±ï¸ Ø§Ù„Ù…Ø¯Ø©: $MIN Ø¯Ù‚ÙŠÙ‚Ø©%0AğŸ“¦ Ø§Ù„Ø­Ø¬Ù…: $SIZE" \
          "https://api.telegram.org/bot$TOKEN/sendVideo?chat_id=$CHAT_ID"
          
