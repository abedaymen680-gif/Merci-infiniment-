name: IPTV to GitHub Direct Link

on:
  workflow_dispatch:

jobs:
  build_and_release:
    runs-on: ubuntu-latest
    permissions:
      contents: write # Ø¶Ø±ÙˆØ±ÙŠ Ù„Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ø³ÙƒØ±Ø¨Øª Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
    steps:
      - name: Install FFmpeg
        run: sudo apt-get update && sudo apt-get install -y ffmpeg

      - name: Capture 1 Minute
        run: |
          ffmpeg -reconnect 1 -reconnect_at_eof 1 -reconnect_streamed 1 \
          -i "http://front-main.eagle-4k.me:80/live/imadfr_551967/4fWxfRqg/269.ts" \
          -t 60 -c copy video_test.mp4

      - name: Upload to GitHub Releases
        uses: softprops/action-gh-release@v1
        with:
          tag_name: video-v1
          files: video_test.mp4
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Show Final Link
        run: |
          echo "--------------------------------------------------"
          echo "âœ… ØªÙ… Ø§Ù„Ø±ÙØ¹ Ø¹Ù„Ù‰ Ø³ÙŠØ±ÙØ±Ø§Øª GitHub Ø¨Ù†Ø¬Ø§Ø­!"
          echo "ğŸ”— Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ù‡Ùˆ:"
          echo "https://github.com/${{ github.repository }}/releases/download/video-v1/video_test.mp4"
          echo "--------------------------------------------------"
